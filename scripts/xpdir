#!/usr/bin/env python2.3
import os, sys
from plearn.xperiments.Xperiment import *

def listdir( targets, xperiments ):
    print "\n","\n".join([ str(x) for x in xperiments ])

def mkdir( targets, xperiments ):
    for exp in xperiments:
        if exp.infos:
            dirname = "_".join([ "%s=%s" % (lhs, str(rhs))
                                 for (lhs, rhs) in exp.infos ])

            if not os.path.exists( dirname ):
                os.mkdir( dirname )                
            os.system("(cd %s; ln -s ../%s)" % (dirname, exp.path))
    
### Main program
mode    = listdir
targets = sys.argv[1:]
if len(sys.argv) > 1 and sys.argv[1] == "mkdir":    
    mode    = mkdir
    targets = sys.argv[2:]

### Starting the selected mode
mode( targets, Xperiment.match(targets) )
