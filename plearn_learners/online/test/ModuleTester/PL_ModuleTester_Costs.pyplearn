# Run safety checks on costs that can use a gradient w.r.t. their output.
# Currently this is only 'CrossEntropyCostModule' (the ModuleTester needs to
# be upgraded in order to be able to test NLLCostModule for instance).

from plearn.pyplearn import pl

configurations = [ {"in_grad":[ "prediction" ],
                    "in_nograd":[ "target" ],
                    "out_grad":[ "cost" ]} ]

testers = [

    pl.ModuleTester(
            module = pl.CrossEntropyCostModule(
                input_size = 100,
                target_size = 100),
            configurations = configurations),

    ]

def main():
    return pl.RunObject( objects = testers )


